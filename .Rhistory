align = "right",
verticalAlign = "middle"
)
dis_plus <- dis_plus |>
mutate(year_qtr = paste0("Q", qtr, "-", year))
hchart(
object = dis_plus,
mapping = hcaes(x = year_qtr, y = dis_subs),
type = 'line',
color = 'orange',
yAxis = 0,
name = "Disney+ Subscribers (Millions)"
) %>%
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = nflx_subs),
type = 'line',
color = 'red',
yAxis = 1,
name = "Subscriber Counts for Disney+ and Netflix"
) %>%
hc_yAxis_multiples(
list(title = list(text = 'Disney+ Subscribers (in Millions)', style = list(color = "orange"))),
list(opposite = TRUE, title = list(text = 'Netflix Subscribers (in Millions)', style = list(color = "red")))
) %>%
hc_title(text = "Subscriber Counts for Disney+ and Netflix", align = "center") %>%
hc_xAxis(
title = list(text = "Year and Quarter"),
categories = unique(dis_plus$year_qtr),
tickInterval = 1
) %>%
hc_legend(
align = "right",
verticalAlign = "middle"
)
dis_plus <- dis_plus |>
mutate(year_qtr = paste0("Q", qtr, "-", year))
highchart() |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = dis_subs),
type = 'line',
color = 'orange',
yAxis = 0,
name = "Disney+ Subscribers (Millions)"
) |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = nflx_subs),
type = 'line',
color = 'red',
yAxis = 1,
name = "Subscriber Counts for Disney+ and Netflix"
) |>
hc_yAxis_multiples(
list(title = list(text = 'Disney+ Subscribers (in Millions)', style = list(color = "orange"))),
list(opposite = TRUE, title = list(text = 'Netflix Subscribers (in Millions)', style = list(color = "red")))
) |>
hc_title(text = "Subscriber Counts for Disney+ and Netflix", align = "center") |>
hc_xAxis(
title = list(text = "Year and Quarter"),
categories = unique(dis_plus$year_qtr),
tickInterval = 1
) |>
hc_legend(
align = "right",
verticalAlign = "middle"
)
dis_plus <- dis_plus |>
mutate(year_qtr = paste0("Q", qtr, "-", year))
highchart() |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = dis_subs),
type = 'line',
color = 'orange',
yAxis = 0,
name = "Disney+ Subscribers (Millions)"
) |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = nflx_subs),
type = 'line',
color = 'red',
yAxis = 1,
name = "Subscriber Counts for Disney+ and Netflix"
) |>
hc_yAxis_multiples(
list(title = list(text = 'Disney+ Subscribers (in Millions)', style = list(color = "orange"))),
list(opposite = TRUE, title = list(text = 'Netflix Subscribers (in Millions)', style = list(color = "red")))
) |>
hc_title(text = "Subscriber Counts for Disney+ and Netflix", align = "center") |>
hc_xAxis(
title = list(text = "Year and Quarter"),
categories = unique(dis_plus$year_qtr),
tickInterval = 1
) |>
hc_legend(
align = "bottom",
verticalAlign = "middle"
)
dis_plus <- dis_plus |>
mutate(year_qtr = paste0("Q", qtr, "-", year))
highchart() |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = dis_subs),
type = 'line',
color = 'orange',
yAxis = 0,
name = "Disney+ Subscribers (Millions)"
) |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = nflx_subs),
type = 'line',
color = 'red',
yAxis = 1,
name = "Subscriber Counts for Disney+ and Netflix"
) |>
hc_yAxis_multiples(
list(title = list(text = 'Disney+ Subscribers (in Millions)', style = list(color = "orange"))),
list(opposite = TRUE, title = list(text = 'Netflix Subscribers (in Millions)', style = list(color = "red")))
) |>
hc_title(text = "Subscriber Counts for Disney+ and Netflix", align = "center") |>
hc_xAxis(
title = list(text = "Year and Quarter"),
categories = unique(dis_plus$year_qtr),
tickInterval = 1
) |>
hc_legend(
align = "bottom",
verticalAlign = "bottom"
)
dis_plus <- dis_plus |>
mutate(year_qtr = paste0("Q", qtr, "-", year))
highchart() |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = dis_subs),
type = 'line',
color = 'orange',
yAxis = 0,
name = "Disney+ Subscribers (Millions)"
) |>
hc_add_series(
data = dis_plus,
mapping = hcaes(x = year_qtr, y = nflx_subs),
type = 'line',
color = 'red',
yAxis = 1,
name = "Subscriber Counts for Disney+ and Netflix"
) |>
hc_yAxis_multiples(
list(title = list(text = 'Disney+ Subscribers (in Millions)', style = list(color = "orange"))),
list(opposite = TRUE, title = list(text = 'Netflix Subscribers (in Millions)', style = list(color = "red")))
) |>
hc_title(text = "Subscriber Counts for Disney+ and Netflix", align = "center") |>
hc_xAxis(
title = list(text = "Year and Quarter"),
categories = unique(dis_plus$year_qtr),
tickInterval = 1
) |>
hc_legend(
align = "left",
verticalAlign = "bottom"
)
filtered_dis_stocks <- dis_stock |>
mutate(percentage = ((close - open) / open) * 100 ) |>
filter(percentage >= 5 | percentage <= -5)
filtered_dis_stocks <- dis_stock |>
mutate(percentage = ((close - open) / open) * 100 ) |>
filter(percentage >= 5 | percentage <= -5)
#| message: false
dis_stock = read_csv(file = 'https://www.dropbox.com/scl/fi/x25yj3rp81dn1tipguqk5/dis_stock.csv?rlkey=6j7gkdei81aipn0kem0i34tit&st=rps4871p&raw=1')
filtered_dis_stocks <- dis_stock |>
mutate(percentage = ((close - open) / open) * 100 ) |>
filter(percentage >= 5 | percentage <= -5)
filtered_dis_stocks |>
gt() |>
tab_header(
title = "Trading Days of DIS Stocks with at least 5% Gain or Loss"
) |>
cols_label(
date = html("Date"),
open = html("Open"),
high = html("High"),
low = html("Low"),
close = html("Close"),
volume = html("Volume"),
spx = html("SPX"),
shrsout = html("Outstanding Shares"),
percentage = html("Chang Over 5%")
) |>
opt_stylize(style = 6, color = "pink")
dis_stock_with_market_cap <-  dis_stock |>
mutate(market_cap = close * shrsout,
date_movement = abs(market_cap - lag(market_cap)))
dis_stock_with_market_cap <- dis_stock_with_market_cap |>
mutate(date_movement = ifelse(is.na(date_movement), 0, date_movement))
peak_market_cap_date = dis_stock_with_market_cap |>
filter(market_cap == max(market_cap)) |>
pull(date)
# the market capitalization of DIS was at its peak on 2021-03-08
paste("The market capitalization of DIS was at its peak on", peak_market_cap_date)
greatest_monthly_movement <- dis_stock_with_market_cap |>
filter(date_movement == max(date_movement)) |>
pull(date)
# the greatest movement of market cap happened in Decemeber of 2020, specifically on 2020-12-10
paste("The greatest movement of market cap happened in Decemeber of 2020, specifically on", greatest_monthly_movement)
stock <- dis_stock %>%
filter(date >= as.Date("2021-01-02") & date <= as.Date("2024-12-31")) %>%
mutate(
# dis_growth = close / last(close),
# spx_growth = spx / last(spx)
shares = 1 / last(close),
dis_growth = shares * close,
spx_shares = 1 / last(spx),
spx_growth = spx_shares * spx
) %>%
select(date, dis_growth, spx_growth)
print(stock, n = 1005)
plot <- stock %>%
ggplot(aes(x = date)) +
geom_line(aes(y = dis_growth, color = "DIS"), linewidth = 1) +
geom_line(aes(y = spx_growth, color = "S&P 500"), linewidth = 1) +
scale_color_manual(values = c("DIS" = "blue", "S&P 500" = "red")) +
scale_x_date(date_breaks = "3 months", date_labels = "%Y-%m") +
scale_y_continuous(breaks = seq(0, 2, by = 0.1)) +
labs(
title = "Growth of $1 Investment (1/2/2021-12/31/2024)",
x = "Date",
y = "Value of Investment ($)",
color = "Investment"
) +
theme_classic()
plot
dis_stock1 = dis_stock %>%
filter(year(date) == 2024)
dis_stock1 %>%
hchart(
object = dis_stock1,
mapping = hcaes(x = date, y = open),
type = 'line',
name = 'Open',
color = 'red'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = high),
type = 'line',
name = 'High',
color = 'blue'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = low),
type = 'line',
name = 'Low',
color = 'green'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = close),
type = 'line',
name = 'Close',
color = 'purple'
) %>%
hc_xAxis(title = list(text = '2024 Trading Day')) %>%
hc_yAxis(title = list(text = 'Share Price')) %>%
hc_title(text = "Disney Intra-Day Stock Price") %>%
hc_legend(
align = "right",
verticalAlign = "middle",
layout = "vertical"
)
dis_stock1 = dis_stock %>%
filter(year(date) == 2024)
dis_stock1 %>%
hchart() %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = open),
type = 'line',
name = 'Open',
color = 'red'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = high),
type = 'line',
name = 'High',
color = 'blue'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = low),
type = 'line',
name = 'Low',
color = 'green'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = close),
type = 'line',
name = 'Close',
color = 'purple'
) %>%
hc_xAxis(title = list(text = '2024 Trading Day')) %>%
hc_yAxis(title = list(text = 'Share Price')) %>%
hc_title(text = "Disney Intra-Day Stock Price") %>%
hc_legend(
align = "right",
verticalAlign = "middle",
layout = "vertical"
)
dis_stock1 = dis_stock %>%
filter(year(date) == 2024)
hchart() %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = open),
type = 'line',
name = 'Open',
color = 'red'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = high),
type = 'line',
name = 'High',
color = 'blue'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = low),
type = 'line',
name = 'Low',
color = 'green'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = close),
type = 'line',
name = 'Close',
color = 'purple'
) %>%
hc_xAxis(title = list(text = '2024 Trading Day')) %>%
hc_yAxis(title = list(text = 'Share Price')) %>%
hc_title(text = "Disney Intra-Day Stock Price") %>%
hc_legend(
align = "right",
verticalAlign = "middle",
layout = "vertical"
)
dis_stock1 = dis_stock %>%
filter(year(date) == 2024)
dis_stock1 %>%
hchart() %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = open),
type = 'line',
name = 'Open',
color = 'red'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = high),
type = 'line',
name = 'High',
color = 'blue'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = low),
type = 'line',
name = 'Low',
color = 'green'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = close),
type = 'line',
name = 'Close',
color = 'purple'
) %>%
hc_xAxis(title = list(text = '2024 Trading Day')) %>%
hc_yAxis(title = list(text = 'Share Price')) %>%
hc_title(text = "Disney Intra-Day Stock Price") %>%
hc_legend(
align = "right",
verticalAlign = "middle",
layout = "vertical"
)
dis_stock1 = dis_stock %>%
filter(year(date) == 2024)
hchart() %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = open),
type = 'line',
name = 'Open',
color = 'red'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = high),
type = 'line',
name = 'High',
color = 'blue'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = low),
type = 'line',
name = 'Low',
color = 'green'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = close),
type = 'line',
name = 'Close',
color = 'purple'
) %>%
hc_xAxis(title = list(text = '2024 Trading Day')) %>%
hc_yAxis(title = list(text = 'Share Price')) %>%
hc_title(text = "Disney Intra-Day Stock Price") %>%
hc_legend(
align = "right",
verticalAlign = "middle",
layout = "vertical"
)
dis_stock1 = dis_stock %>%
filter(year(date) == 2024)
hchart() %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = open),
type = 'line',
name = 'Open',
color = 'red'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = high),
type = 'line',
name = 'High',
color = 'blue'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = low),
type = 'line',
name = 'Low',
color = 'green'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = close),
type = 'line',
name = 'Close',
color = 'purple'
) %>%
hc_xAxis(title = list(text = '2024 Trading Day')) %>%
hc_yAxis(title = list(text = 'Share Price')) %>%
hc_title(text = "Disney Intra-Day Stock Price") %>%
hc_legend(
align = "right",
verticalAlign = "middle",
layout = "vertical"
)
dis_stock1 = dis_stock %>%
filter(year(date) == 2024)
highchart() %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = open),
type = 'line',
name = 'Open',
color = 'red'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = high),
type = 'line',
name = 'High',
color = 'blue'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = low),
type = 'line',
name = 'Low',
color = 'green'
) %>%
hc_add_series(
data = dis_stock1,
mapping = hcaes(x = date, y = close),
type = 'line',
name = 'Close',
color = 'purple'
) %>%
hc_xAxis(title = list(text = '2024 Trading Day')) %>%
hc_yAxis(title = list(text = 'Share Price')) %>%
hc_title(text = "Disney Intra-Day Stock Price") %>%
hc_legend(
align = "right",
verticalAlign = "middle",
layout = "vertical"
)
